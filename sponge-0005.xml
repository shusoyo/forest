<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="default.xsl"?>
<fr:tree
toc="true"
numbered="true"
show-heading="true"
show-metadata="true"
expanded="true"
root="false"
xmlns:fr="http://www.jonmsterling.com/jms-005P.xml"><fr:frontmatter><fr:anchor>305</fr:anchor><fr:addr
type="user">sponge-0005</fr:addr><fr:route>sponge-0005.xml</fr:route><fr:title
text="TCP Segment">TCP Segment</fr:title><fr:taxon>Figure</fr:taxon><fr:date><fr:year>2024</fr:year><fr:month>9</fr:month><fr:day>18</fr:day></fr:date><fr:authors><fr:author><fr:link
type="local"
href="epoche.xml"
addr="epoche"
title="Epoche">Epoche</fr:link></fr:author></fr:authors></fr:frontmatter><fr:mainmatter><html:figure
xmlns:html="http://www.w3.org/1999/xhtml">
  <html:img
src="tcp_segment_header.png" />
  <fr:figcaption>TCP segment</fr:figcaption>
</html:figure></fr:mainmatter><fr:backmatter><fr:tree
toc="false"
numbered="false"
show-heading="true"
show-metadata="false"
expanded="true"
root="false"
xmlns:fr="http://www.jonmsterling.com/jms-005P.xml"><fr:frontmatter><fr:title
text="Backlinks">Backlinks</fr:title><fr:authors /></fr:frontmatter><fr:mainmatter><fr:tree
toc="true"
numbered="false"
show-heading="true"
show-metadata="true"
expanded="false"
root="false"
xmlns:fr="http://www.jonmsterling.com/jms-005P.xml"><fr:frontmatter><fr:anchor>307</fr:anchor><fr:addr
type="user">sponge-0004</fr:addr><fr:route>sponge-0004.xml</fr:route><fr:title
text="Sponge Lab 2: the TCP Receiver">Sponge Lab 2: the TCP Receiver</fr:title><fr:date><fr:year>2024</fr:year><fr:month>9</fr:month><fr:day>18</fr:day></fr:date><fr:authors><fr:author><fr:link
type="local"
href="epoche.xml"
addr="epoche"
title="Epoche">Epoche</fr:link></fr:author></fr:authors></fr:frontmatter><fr:mainmatter><fr:p>TCP Receiver receives the <fr:link
type="local"
href="sponge-0005.xml"
addr="sponge-0005"
title="TCP Segment">TCP segment</fr:link> and the payload of the datagram, <fr:link
type="local"
href="sponge-0003.xml"
addr="sponge-0003"
title="Sponge Lab 1: stitching substrings into a byte stream">reassembler</fr:link> in receiver reassembling the bytes and pushing into bytestream, so that code can read the data from bytestream with TCP socket read function(such as the <fr:link
type="local"
href="sponge-0002.xml"
addr="sponge-0002"
title="Sponge Lab 0: networking warmup">first lab</fr:link>). Additinoally, receiver also send the acknowledgement number and window size to control the flow of incoming data.</fr:p><fr:p>Firstly we need to implement the conversion functions that can convert the sequence number to the absolute sequence number, ensuring that <fr:code>unwrap</fr:code> and <fr:code>wrap</fr:code> are correct. The <fr:code>segment_received</fr:code> function will call the <fr:code>push_substring</fr:code> function to push the payload to the reassembler. When the syn flag is true, we must set the index is 0 regardless of the empty payload.</fr:p><fr:p>In <fr:code>ackno</fr:code> function, it needs to add 1 when recieve the syn flag because syn also occupies a seq number. About the fin flag, we can check the status of bytestream and plus ackno 1 if it is closed.</fr:p></fr:mainmatter><fr:backmatter /></fr:tree></fr:mainmatter><fr:backmatter /></fr:tree></fr:backmatter></fr:tree>